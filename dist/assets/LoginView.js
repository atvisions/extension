import{d as e,r as a,c as s,b as l,u as r,q as t,s as o,e as u,t as i,v as d,x as n,h as m,k as p,l as c,m as v,y as b,p as f}from"./main.js";import{b as g}from"./index.js";const x={class:"min-h-screen flex flex-col bg-[#0F172A] overflow-y-auto"},y={class:"fixed top-0 w-full z-10 bg-[#0F172A]/95 backdrop-blur-md border-b border-gray-800"},w={class:"max-w-[375px] mx-auto"},k={class:"flex items-center px-4 py-3"},h={class:"flex-1 pt-16 pb-16"},q={class:"max-w-[375px] mx-auto px-4"},S={key:0,class:"p-3 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-sm"},A=["disabled"],I={class:"mt-6 text-center"},N={class:"text-sm text-gray-400"},O=e({__name:"LoginView",setup(e){const O=t(),V=b(),_=a({email:"",password:""}),j=a(!1),C=a(null),E=async()=>{var e,a,s,l,r;if(C.value=null,_.value.email&&_.value.password){j.value=!0;try{const a=await g.login({email:_.value.email.trim(),password:_.value.password.trim()});if("success"===a.status&&(null==(e=a.data)?void 0:e.token)){localStorage.setItem("token",`Token ${a.data.token}`),localStorage.setItem("userInfo",JSON.stringify(a.data.user));const e=V.query.redirect||"/";O.push(e)}else C.value="登录失败：未获取到 token"}catch(t){console.error("登录失败:",t),(null==(s=null==(a=t.response)?void 0:a.data)?void 0:s.message)?t.value=t.response.data.message:401===(null==(l=t.response)?void 0:l.status)?t.value="邮箱或密码错误":429===(null==(r=t.response)?void 0:r.status)?t.value="登录尝试次数过多，请稍后再试":"ECONNABORTED"===t.code?t.value="网络连接超时，请检查网络":t.value="登录失败，请稍后重试"}finally{j.value=!1}}else C.value="请填写所有必填字段"};return(e,a)=>{const t=v("router-link");return f(),s("div",x,[l("header",y,[l("div",w,[l("div",k,[l("button",{onClick:a[0]||(a[0]=e=>r(O).push("/")),class:"mr-2"},a[3]||(a[3]=[l("i",{class:"ri-arrow-left-line ri-lg"},null,-1)])),a[4]||(a[4]=l("h1",{class:"text-lg font-semibold"},"登录",-1))])])]),l("main",h,[l("div",q,[l("form",{onSubmit:o(E,["prevent"]),class:"space-y-6"},[C.value?(f(),s("div",S,i(C.value),1)):u("",!0),l("div",null,[a[5]||(a[5]=l("label",{for:"email",class:"block text-sm font-medium text-gray-300 mb-1"},"邮箱",-1)),d(l("input",{id:"email","onUpdate:modelValue":a[1]||(a[1]=e=>_.value.email=e),type:"email",class:"w-full px-4 py-2 rounded-lg bg-gray-800 border border-gray-700 focus:border-primary focus:ring-1 focus:ring-primary outline-none",required:""},null,512),[[n,_.value.email]])]),l("div",null,[a[6]||(a[6]=l("label",{for:"password",class:"block text-sm font-medium text-gray-300 mb-1"},"密码",-1)),d(l("input",{id:"password","onUpdate:modelValue":a[2]||(a[2]=e=>_.value.password=e),type:"password",class:"w-full px-4 py-2 rounded-lg bg-gray-800 border border-gray-700 focus:border-primary focus:ring-1 focus:ring-primary outline-none",required:""},null,512),[[n,_.value.password]])]),l("button",{type:"submit",class:"w-full py-3 bg-gradient-to-r from-primary to-blue-500 text-white rounded-lg font-medium",disabled:j.value},i(j.value?"登录中...":"登录"),9,A)],32),l("div",I,[l("p",N,[a[8]||(a[8]=m(" 还没有账号？ ")),p(t,{to:"/register",class:"text-primary hover:underline"},{default:c((()=>a[7]||(a[7]=[m("立即注册")]))),_:1})])])])])])}}});export{O as default};
